<!DOCTYPE HTML>

<html>
<head>
	<title>Bandwagn</title>
	<meta charset=utf-8 />
	<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
	<script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript">
      	google.load("visualization", "1", {packages:["geochart"]});
      	google.setOnLoadCallback(drawRegionsMap);

      	function drawRegionsMap() {
	      	var storedLocations = getClientLocations();
	        /*var data = google.visualization.arrayToDataTable([
	          ['City'],
	          ['Stoughton'],
	        ]);*/
			if (storedLocations === null) {
				alert("No data to display");
			} else {
		        var data = new google.visualization.DataTable();

		        data.addColumn('string', 'City');

		        jQuery.each(storedLocations, function(index, value) {
		        	data.addRow(["'" + this + "'"]);
		        });

		        var options = {
						        region: 'US',
						        displayMode: 'markers'
						      };

		        var chart = new google.visualization.GeoChart(document.getElementById('geochart'));

		        chart.draw(data, options);
		    }
		}

      function getClientLocations() {
 			var storedLocations = new Array();

			if (localStorage) {
  			// LocalStorage is supported!
	  			if ("Bandwagn" in localStorage) {
	  				storedLocations = JSON.parse(localStorage.getItem("Bandwagn"));
	  				return storedLocations;
				} else {
					return null;
				}
			} else {
  			// No support. Use a fallback such as browser cookies or store on the server.
  				alert("Local storage not supported! Try a different browser.")
			}
 		}
    </script>			
</head>

<body>
	<h1>Bandwagn History</h1>
	<nav>
		<ul>
			<li><a href="indextest.html">home</a></li>
			<li><a href="history.html">history</a></li>
		</ul>
	</nav>
	<div id="geochart" width="900px" height="500px"></div>
</body>
</html>